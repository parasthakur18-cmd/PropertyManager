Perfect ğŸ‘Œ now we do this the correct production way (not hardcoding).

Since your source of truth is Replit, you should fix it there and then push to VPS.

â¸»

ğŸ¯ What Is Actually Wrong?

Your backend is generating:

redirect_uri=http://localhost:5000/api/auth/google/callback

That means in your Replit code:
	â€¢	It is detecting domain as localhost
	â€¢	It is not using production domain
	â€¢	Or it is not respecting NODE_ENV=production

â¸»

âœ… PROPER FIX (Clean & Production Safe)

We will:
	1.	Add a new env variable: APP_BASE_URL
	2.	Use it for Google callback
	3.	Push to GitHub
	4.	Pull on VPS
	5.	Rebuild

This is the clean DevOps way.

â¸»

ğŸ›  STEP 1 â€” Update Code in Replit

Open this file in Replit:

server/replitAuth.ts

Find this line:

const callbackURL = `${protocol}://${primaryDomain}/api/auth/google/callback`;


â¸»

ğŸ”¥ Replace It With This:

const baseUrl =
  process.env.APP_BASE_URL ||
  `${protocol}://${primaryDomain}`;

const callbackURL = `${baseUrl}/api/auth/google/callback`;


â¸»

ğŸ›  STEP 2 â€” Add Environment Variable in VPS

Edit your PM2 config (ecosystem.config.cjs):

Add this:

APP_BASE_URL: 'https://hostezee.in',

Inside env block.

Example:

env: {
  NODE_ENV: 'production',
  PORT: '3000',
  APP_BASE_URL: 'https://hostezee.in',
  GOOGLE_CLIENT_ID: '911079886676-6pefghc3dtg3jrmu8dbb7si41u6lj6gk.apps.googleusercontent.com',
  GOOGLE_CLIENT_SECRET: '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',
  ...
}


â¸»

ğŸ›  STEP 3 â€” Push From Replit

In Replit shell:

git add .
git commit -m "Fix Google OAuth callback URL for production"
git push origin main


â¸»

ğŸ›  STEP 4 â€” Pull on VPS

On VPS:

cd /var/www/myapp
git pull origin main
rm -rf dist
npm run build
pm2 restart propertymanager --update-env
pm2 save


â¸»

ğŸ›  STEP 5 â€” Verify

Run:

curl -I https://hostezee.in/api/auth/google

You should now see:

redirect_uri=https://hostezee.in/api/auth/google/callback

If you see localhost â†’ something still wrong
If you see hostezee.in â†’ Google login will work immediately

â¸»

ğŸ§  Why This Is Best Practice

Hardcoding domain âŒ bad
Using env variable âœ… correct DevOps pattern

Now your app works:
	â€¢	On Replit (dev)
	â€¢	On VPS (prod)
	â€¢	On any future domain

â¸»

After you push + rebuild, paste your new curl output.

We finish this cleanly ğŸš€