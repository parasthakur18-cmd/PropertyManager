# Hostezee Complete Workflow Diagrams

## ğŸ”„ Automatic Data Propagation System

### Overview Flowchart

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER PERFORMS ACTION                          â”‚
â”‚  Examples: Create booking, Record payment, Cancel reservation, etc.  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FRONTEND MUTATION TRIGGERED                       â”‚
â”‚  (via TanStack Query useMutation in React components)                â”‚
â”‚                                                                       â”‚
â”‚  Example: createBookingMutation.mutate(data)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API REQUEST TO BACKEND                           â”‚
â”‚  POST /api/bookings                                                   â”‚
â”‚  PATCH /api/bookings/:id                                              â”‚
â”‚  DELETE /api/bookings/:id                                             â”‚
â”‚  etc.                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BACKEND ROUTE HANDLER                               â”‚
â”‚  (server/routes.ts)                                                   â”‚
â”‚                                                                       â”‚
â”‚  1. Authenticate request âœ“                                            â”‚
â”‚  2. Validate data (Zod) âœ“                                             â”‚
â”‚  3. Check permissions âœ“                                               â”‚
â”‚  4. Call storage layer â†“                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STORAGE LAYER (server/storage.ts)                  â”‚
â”‚                                                                       â”‚
â”‚  async createBooking(data) {                                          â”‚
â”‚    // 1. Start database transaction                                  â”‚
â”‚    const booking = await db.insert(bookings).values(data)            â”‚
â”‚                                                                       â”‚
â”‚    // 2. Publish domain event â­ NEW!                                 â”‚
â”‚    EventBus.publish({                                                 â”‚
â”‚      type: 'BOOKING_CREATED',                                         â”‚
â”‚      data: booking,                                                   â”‚
â”‚      propertyId: booking.propertyId,                                  â”‚
â”‚      userId: currentUser.id                                           â”‚
â”‚    })                                                                 â”‚
â”‚                                                                       â”‚
â”‚    // 3. Return result                                               â”‚
â”‚    return booking                                                     â”‚
â”‚  }                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CENTRAL EVENT BUS (server/eventBus.ts)               â”‚
â”‚                                                                       â”‚
â”‚  class EventBus {                                                     â”‚
â”‚    private subscribers = new Map<EventType, Handler[]>()             â”‚
â”‚                                                                       â”‚
â”‚    publish(event: DomainEvent) {                                      â”‚
â”‚      // 1. Add to in-memory queue                                    â”‚
â”‚      this.eventQueue.push(event)                                      â”‚
â”‚                                                                       â”‚
â”‚      // 2. Notify all subscribers                                    â”‚
â”‚      const handlers = this.subscribers.get(event.type)               â”‚
â”‚      handlers.forEach(handler => handler(event))                     â”‚
â”‚                                                                       â”‚
â”‚      // 3. Send to SSE clients (frontend listeners)                  â”‚
â”‚      this.broadcastToClients(event)                                   â”‚
â”‚    }                                                                  â”‚
â”‚  }                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                  â”‚
           â”‚                                  â”‚
           â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND SSE LISTENER   â”‚      â”‚  BACKEND EVENT HANDLERS           â”‚
â”‚  (Real-time Updates)     â”‚      â”‚  (Computed Data Updates)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                  â”‚
           â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EventBusProvider.tsx     â”‚      â”‚ Analytics Recalculation           â”‚
â”‚                          â”‚      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚ useEffect(() => {        â”‚      â”‚ EventBus.on('BOOKING_CREATED',   â”‚
â”‚   const eventSource =    â”‚      â”‚   async (event) => {              â”‚
â”‚     new EventSource(     â”‚      â”‚     await recalculateStats()      â”‚
â”‚       '/api/events'      â”‚      â”‚     await updateOccupancyRate()   â”‚
â”‚     )                    â”‚      â”‚   }                               â”‚
â”‚                          â”‚      â”‚ )                                 â”‚
â”‚   eventSource.onmessage  â”‚      â”‚                                   â”‚
â”‚     = (msg) => {         â”‚      â”‚ EventBus.on('PAYMENT_RECEIVED',  â”‚
â”‚       const event =      â”‚      â”‚   async (event) => {              â”‚
â”‚         JSON.parse(      â”‚      â”‚     await updateRevenue()         â”‚
â”‚         msg.data)        â”‚      â”‚     await recalculatePL()         â”‚
â”‚                          â”‚      â”‚   }                               â”‚
â”‚       // Map event to    â”‚      â”‚ )                                 â”‚
â”‚       // cache            â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚       // invalidation    â”‚
â”‚       invalidateCache(   â”‚
â”‚         event.type       â”‚
â”‚       )                  â”‚
â”‚     }                    â”‚
â”‚ }, [])                   â”‚
â”‚                          â”‚
â”‚ function                 â”‚
â”‚ invalidateCache(type) {  â”‚
â”‚   switch(type) {         â”‚
â”‚     case                 â”‚
â”‚     'BOOKING_CREATED':   â”‚
â”‚       queryClient        â”‚
â”‚         .invalidate([    â”‚
â”‚           '/api/bookings'â”‚
â”‚         ])               â”‚
â”‚       queryClient        â”‚
â”‚         .invalidate([    â”‚
â”‚           '/api/rooms'   â”‚
â”‚         ])               â”‚
â”‚       queryClient        â”‚
â”‚         .invalidate([    â”‚
â”‚           '/api/analyticsâ”‚
â”‚         ])               â”‚
â”‚       break              â”‚
â”‚   }                      â”‚
â”‚ }                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REACT QUERY CACHE       â”‚
â”‚  AUTOMATICALLY REFETCHES â”‚
â”‚                          â”‚
â”‚  â€¢ /api/bookings         â”‚
â”‚  â€¢ /api/rooms            â”‚
â”‚  â€¢ /api/analytics        â”‚
â”‚  â€¢ /api/dashboard/stats  â”‚
â”‚  â€¢ /api/bills            â”‚
â”‚  â€¢ etc.                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI COMPONENTS UPDATE    â”‚
â”‚  AUTOMATICALLY           â”‚
â”‚                          â”‚
â”‚  â€¢ Bookings list         â”‚
â”‚    refreshes             â”‚
â”‚  â€¢ Room availability     â”‚
â”‚    updates               â”‚
â”‚  â€¢ Dashboard stats       â”‚
â”‚    recalculate           â”‚
â”‚  â€¢ Analytics charts      â”‚
â”‚    redraw                â”‚
â”‚  â€¢ Toast notification    â”‚
â”‚    shows                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Complete Booking Lifecycle Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          START: ENQUIRY                              â”‚
â”‚  Guest contacts property for room availability                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Staff creates  â”‚
            â”‚ ENQUIRY        â”‚
            â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
            â”‚ â€¢ Guest info   â”‚
            â”‚ â€¢ Room needed  â”‚
            â”‚ â€¢ Check dates  â”‚
            â”‚ â€¢ Meal plan    â”‚
            â”‚ â€¢ Quote price  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ EVENT: ENQUIRY_CREATED
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                             â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Enquiries List   â”‚        â”‚ Dashboard Stats       â”‚
         â”‚ â€¢ Add to list    â”‚        â”‚ â€¢ Enquiry count++     â”‚
         â”‚ â€¢ Show badge     â”‚        â”‚ â€¢ Potential revenue++ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Send WhatsApp/   â”‚
         â”‚ SMS Message      â”‚
         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
         â”‚ "Your enquiry    â”‚
         â”‚ #1234 received.  â”‚
         â”‚ Room available   â”‚
         â”‚ at â‚¹2000/night"  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Guest confirms OR        â”‚
         â”‚ Guest requests changes   â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                           â”‚
        â–¼                           â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Update      â”‚           â”‚ Cancel      â”‚
 â”‚ Enquiry     â”‚           â”‚ Enquiry     â”‚
 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚                         â”‚
        â”‚ EVENT:                  â”‚ EVENT:
        â”‚ ENQUIRY_UPDATED         â”‚ ENQUIRY_CANCELLED
        â”‚                         â”‚
        â–¼                         â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Enquiries   â”‚           â”‚ Enquiries   â”‚
 â”‚ List        â”‚           â”‚ List        â”‚
 â”‚ â€¢ Update    â”‚           â”‚ â€¢ Mark      â”‚
 â”‚   details   â”‚           â”‚   cancelled â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONFIRM ENQUIRY    â”‚
â”‚ Convert to Booking â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Creates:
         â”‚ 1. Guest record
         â”‚ 2. Booking record
         â”‚ 3. Room blocking
         â”‚ 4. Initial bill
         â”‚
         â”‚ EVENT: ENQUIRY_CONFIRMED + BOOKING_CREATED
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                 â–¼                 â–¼                â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Enquiries   â”‚   â”‚ Bookings    â”‚  â”‚ Rooms       â”‚  â”‚ Dashboard   â”‚
  â”‚ List        â”‚   â”‚ List        â”‚  â”‚ â€¢ Block     â”‚  â”‚ â€¢ Booking   â”‚
  â”‚ â€¢ Remove OR â”‚   â”‚ â€¢ Add new   â”‚  â”‚   dates     â”‚  â”‚   count++   â”‚
  â”‚ â€¢ Mark      â”‚   â”‚   booking   â”‚  â”‚ â€¢ Status:   â”‚  â”‚ â€¢ Revenue++ â”‚
  â”‚   converted â”‚   â”‚ â€¢ Badge++   â”‚  â”‚   occupied  â”‚  â”‚             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BOOKING CREATED (Confirmed)                      â”‚
â”‚  Status: "confirmed" or "pending"                                   â”‚
â”‚  Room(s): Blocked for dates                                         â”‚
â”‚  Guest: Created in system                                           â”‚
â”‚  Bill: Initial bill generated                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Guest Arrives  â”‚
            â”‚ CHECK-IN       â”‚
            â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
            â”‚ â€¢ Verify ID    â”‚
            â”‚ â€¢ Upload proof â”‚
            â”‚ â€¢ Collect      â”‚
            â”‚   advance      â”‚
            â”‚ â€¢ Hand keys    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ EVENT: BOOKING_CHECKED_IN + PAYMENT_RECEIVED
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                             â–¼                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Active Bookings  â”‚        â”‚ Bookings List     â”‚  â”‚ Rooms    â”‚
         â”‚ â€¢ Add to list    â”‚        â”‚ â€¢ Status:         â”‚  â”‚ â€¢ Status:â”‚
         â”‚ â€¢ Show room,     â”‚        â”‚   "checked-in"    â”‚  â”‚   occupied
         â”‚   guest details  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IN-HOUSE GUEST SERVICES                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                      â–¼              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Room Serviceâ”‚      â”‚ CafÃ© Order  â”‚  â”‚ Add-on       â”‚
  â”‚ Order       â”‚      â”‚ (Walk-in    â”‚  â”‚ Services     â”‚
  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚  then link) â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
  â”‚ â€¢ Scan QR   â”‚      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â€¢ Taxi       â”‚
  â”‚ â€¢ Auto-fill â”‚      â”‚ â€¢ Name/Phoneâ”‚  â”‚ â€¢ Guide      â”‚
  â”‚   room      â”‚      â”‚ â€¢ Mark "In- â”‚  â”‚ â€¢ Adventure  â”‚
  â”‚ â€¢ Select    â”‚      â”‚   House     â”‚  â”‚ â€¢ Package    â”‚
  â”‚   items     â”‚      â”‚   Guest"    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚ â€¢ Submit    â”‚      â”‚ â€¢ Link to   â”‚         â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚   booking   â”‚         â”‚
         â”‚             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
         â”‚                    â”‚                â”‚
         â”‚ EVENT:             â”‚ EVENT:         â”‚ EVENT:
         â”‚ ORDER_PLACED       â”‚ ORDER_PLACED   â”‚ SERVICE_ADDED
         â”‚                    â”‚                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ Auto-merge to Bill   â”‚
       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
       â”‚ â€¢ Room charges       â”‚
       â”‚ â€¢ Food orders        â”‚
       â”‚ â€¢ Add-on services    â”‚
       â”‚ â€¢ Subtotal           â”‚
       â”‚ â€¢ Taxes              â”‚
       â”‚ â€¢ Total              â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ Updates:
                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â–¼                    â–¼              â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Active     â”‚      â”‚ Kitchen    â”‚  â”‚ Revenue    â”‚
           â”‚ Bookings   â”‚      â”‚ Dashboard  â”‚  â”‚ Stats      â”‚
           â”‚ â€¢ Show     â”‚      â”‚ â€¢ New      â”‚  â”‚ â€¢ Update   â”‚
           â”‚   order    â”‚      â”‚   order    â”‚  â”‚   F&B      â”‚
           â”‚   summary  â”‚      â”‚ â€¢ Status   â”‚  â”‚   revenue  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   tracking â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Guest Departs  â”‚
         â”‚ CHECK-OUT      â”‚
         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
         â”‚ â€¢ Generate     â”‚
         â”‚   final bill   â”‚
         â”‚ â€¢ Merge cafÃ©   â”‚
         â”‚   bills        â”‚
         â”‚ â€¢ Collect      â”‚
         â”‚   payment      â”‚
         â”‚ â€¢ Print bill   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ EVENT: BOOKING_CHECKED_OUT + BILL_PAID
                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â–¼                             â–¼                â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Active Bookings  â”‚        â”‚ Bookings List     â”‚  â”‚ Rooms    â”‚
      â”‚ â€¢ Remove from    â”‚        â”‚ â€¢ Status:         â”‚  â”‚ â€¢ Status:â”‚
      â”‚   list           â”‚        â”‚   "completed"     â”‚  â”‚   cleaning
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Housekeeping  â”‚
         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
         â”‚ Clean room    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ EVENT: ROOM_STATUS_CHANGED (cleaning â†’ available)
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Room Availableâ”‚
         â”‚ for next guestâ”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’° Payment & Financial Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         REVENUE SOURCES                              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Room        â”‚    â”‚ Food &      â”‚    â”‚ Add-on      â”‚
â”‚ Revenue     â”‚    â”‚ Beverage    â”‚    â”‚ Services    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚ Revenue     â”‚    â”‚ Revenue     â”‚
â”‚ â€¢ Booking   â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚   charges   â”‚    â”‚ â€¢ Room      â”‚    â”‚ â€¢ Taxi      â”‚
â”‚ â€¢ Custom    â”‚    â”‚   service   â”‚    â”‚ â€¢ Guide     â”‚
â”‚   pricing   â”‚    â”‚ â€¢ CafÃ©      â”‚    â”‚ â€¢ Adventure â”‚
â”‚ â€¢ Meal plan â”‚    â”‚   orders    â”‚    â”‚ â€¢ Packages  â”‚
â”‚   charges   â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                  â”‚
      â”‚                  â”‚                  â”‚
      â”‚ EVENT:           â”‚ EVENT:           â”‚ EVENT:
      â”‚ PAYMENT_RECEIVED â”‚ ORDER_PLACED     â”‚ SERVICE_ADDED
      â”‚                  â”‚                  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Bill Generation      â”‚
                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
                         â”‚ Subtotal = Room +    â”‚
                         â”‚            F&B +     â”‚
                         â”‚            Services  â”‚
                         â”‚                      â”‚
                         â”‚ Tax = Subtotal Ã— 12% â”‚
                         â”‚                      â”‚
                         â”‚ Total = Subtotal +   â”‚
                         â”‚         Tax          â”‚
                         â”‚                      â”‚
                         â”‚ Balance = Total -    â”‚
                         â”‚           Advance    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Payment Collection   â”‚
                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
                         â”‚ â€¢ Cash               â”‚
                         â”‚ â€¢ Card               â”‚
                         â”‚ â€¢ UPI                â”‚
                         â”‚ â€¢ Bank Transfer      â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ EVENT: BILL_PAID
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â–¼                  â–¼                â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Bills        â”‚   â”‚ Revenue      â”‚  â”‚ Financial    â”‚
                         â”‚ Dashboard    â”‚   â”‚ Reports      â”‚  â”‚ Reports      â”‚
                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€     â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
                         â”‚ â€¢ Mark paid  â”‚   â”‚ â€¢ Daily rev  â”‚  â”‚ â€¢ P&L update â”‚
                         â”‚ â€¢ Archive    â”‚   â”‚ â€¢ Monthly    â”‚  â”‚ â€¢ Income++   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   trends     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚ â€¢ Source     â”‚
                                            â”‚   breakdown  â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EXPENSE TRACKING                             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Manual      â”‚    â”‚ Bank CSV    â”‚    â”‚ Lease       â”‚
â”‚ Entry       â”‚    â”‚ Import      â”‚    â”‚ Payments    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ â€¢ Amount    â”‚    â”‚ â€¢ Upload    â”‚    â”‚ â€¢ Monthly   â”‚
â”‚ â€¢ Category  â”‚    â”‚   file      â”‚    â”‚   rent      â”‚
â”‚ â€¢ Date      â”‚    â”‚ â€¢ Auto-     â”‚    â”‚ â€¢ Schedule  â”‚
â”‚ â€¢ Property  â”‚    â”‚   categorizeâ”‚    â”‚   tracking  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚                  â”‚
      â”‚ EVENT:           â”‚ EVENT:           â”‚ EVENT:
      â”‚ EXPENSE_ADDED    â”‚ EXPENSE_ADDED    â”‚ LEASE_PAYMENT_RECORDED
      â”‚                  â”‚ (bulk)           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Expense              â”‚
                         â”‚ Categorization       â”‚
                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
                         â”‚ â€¢ Staff salaries     â”‚
                         â”‚ â€¢ Utilities          â”‚
                         â”‚ â€¢ Maintenance        â”‚
                         â”‚ â€¢ Food supplies      â”‚
                         â”‚ â€¢ Marketing          â”‚
                         â”‚ â€¢ Property lease     â”‚
                         â”‚ â€¢ Taxes & fees       â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Financial Reports    â”‚
                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
                         â”‚ P&L Statement:       â”‚
                         â”‚                      â”‚
                         â”‚ INCOME               â”‚
                         â”‚ â€¢ Room revenue       â”‚
                         â”‚ â€¢ F&B revenue        â”‚
                         â”‚ â€¢ Services revenue   â”‚
                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚
                         â”‚ Total Income: â‚¹X     â”‚
                         â”‚                      â”‚
                         â”‚ EXPENSES             â”‚
                         â”‚ â€¢ Salaries           â”‚
                         â”‚ â€¢ Utilities          â”‚
                         â”‚ â€¢ Maintenance        â”‚
                         â”‚ â€¢ Lease              â”‚
                         â”‚ â€¢ Others             â”‚
                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚
                         â”‚ Total Expenses: â‚¹Y   â”‚
                         â”‚                      â”‚
                         â”‚ NET PROFIT: â‚¹(X-Y)   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”” Event â†’ Module Update Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EVENT TYPE           â”‚ MODULES THAT AUTO-UPDATE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BOOKING_CREATED      â”‚ â€¢ Bookings list (add new)                      â”‚
â”‚                      â”‚ â€¢ Active bookings (if checked-in)              â”‚
â”‚                      â”‚ â€¢ Rooms (block availability)                   â”‚
â”‚                      â”‚ â€¢ Dashboard (stats++)                          â”‚
â”‚                      â”‚ â€¢ Analytics (booking count++, revenue++)       â”‚
â”‚                      â”‚ â€¢ Calendar (mark dates occupied)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BOOKING_UPDATED      â”‚ â€¢ Bookings list (refresh details)              â”‚
â”‚                      â”‚ â€¢ Active bookings (update info)                â”‚
â”‚                      â”‚ â€¢ Rooms (if room changed)                      â”‚
â”‚                      â”‚ â€¢ Bills (if price changed)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BOOKING_CANCELLED    â”‚ â€¢ Bookings list (mark cancelled)               â”‚
â”‚                      â”‚ â€¢ Active bookings (remove if active)           â”‚
â”‚                      â”‚ â€¢ Rooms (free blocked dates)                   â”‚
â”‚                      â”‚ â€¢ Analytics (update cancellation rate)         â”‚
â”‚                      â”‚ â€¢ Revenue (adjust forecasts)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BOOKING_CHECKED_IN   â”‚ â€¢ Active bookings (add to list)                â”‚
â”‚                      â”‚ â€¢ Bookings (status change)                     â”‚
â”‚                      â”‚ â€¢ Rooms (mark occupied)                        â”‚
â”‚                      â”‚ â€¢ Dashboard (active count++)                   â”‚
â”‚                      â”‚ â€¢ Bills (create initial bill)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BOOKING_CHECKED_OUT  â”‚ â€¢ Active bookings (remove)                     â”‚
â”‚                      â”‚ â€¢ Bookings (status completed)                  â”‚
â”‚                      â”‚ â€¢ Rooms (cleaning/available)                   â”‚
â”‚                      â”‚ â€¢ Dashboard (active count--)                   â”‚
â”‚                      â”‚ â€¢ Revenue (finalize)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PAYMENT_RECEIVED     â”‚ â€¢ Bookings (update payment status)             â”‚
â”‚                      â”‚ â€¢ Bills (reduce balance)                       â”‚
â”‚                      â”‚ â€¢ Revenue reports (add to income)              â”‚
â”‚                      â”‚ â€¢ Analytics (payment stats)                    â”‚
â”‚                      â”‚ â€¢ P&L (income++)                               â”‚
â”‚                      â”‚ â€¢ Dashboard (revenue stats)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ORDER_PLACED         â”‚ â€¢ Kitchen dashboard (new order)                â”‚
â”‚                      â”‚ â€¢ Bills (add items)                            â”‚
â”‚                      â”‚ â€¢ Active bookings (order summary)              â”‚
â”‚                      â”‚ â€¢ Revenue (F&B revenue++)                      â”‚
â”‚                      â”‚ â€¢ Analytics (order stats)                      â”‚
â”‚                      â”‚ â€¢ Notifications (kitchen alert)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ORDER_UPDATED        â”‚ â€¢ Kitchen dashboard (status change)            â”‚
â”‚                      â”‚ â€¢ Bills (update items if changed)              â”‚
â”‚                      â”‚ â€¢ Active bookings (refresh summary)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ORDER_COMPLETED      â”‚ â€¢ Kitchen dashboard (move to completed)        â”‚
â”‚                      â”‚ â€¢ Active bookings (mark delivered)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ROOM_STATUS_CHANGED  â”‚ â€¢ Rooms list (update status badge)             â”‚
â”‚                      â”‚ â€¢ Calendar (update color)                      â”‚
â”‚                      â”‚ â€¢ Availability (if became available)           â”‚
â”‚                      â”‚ â€¢ Dashboard (availability stats)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EXPENSE_ADDED        â”‚ â€¢ Expenses list (add new)                      â”‚
â”‚                      â”‚ â€¢ Financial reports (category totals++)        â”‚
â”‚                      â”‚ â€¢ P&L (expenses++)                             â”‚
â”‚                      â”‚ â€¢ Analytics (expense trends)                   â”‚
â”‚                      â”‚ â€¢ Dashboard (expense stats)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BILL_GENERATED       â”‚ â€¢ Bills dashboard (add new)                    â”‚
â”‚                      â”‚ â€¢ Bookings (link bill)                         â”‚
â”‚                      â”‚ â€¢ Active bookings (show bill)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BILL_PAID            â”‚ â€¢ Bills (mark paid, archive)                   â”‚
â”‚                      â”‚ â€¢ Revenue reports (finalize income)            â”‚
â”‚                      â”‚ â€¢ Bookings (payment complete)                  â”‚
â”‚                      â”‚ â€¢ Analytics (payment stats)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BILLS_MERGED         â”‚ â€¢ Bills list (remove old, add consolidated)    â”‚
â”‚                      â”‚ â€¢ Active bookings (update total)               â”‚
â”‚                      â”‚ â€¢ Checkout dialog (refresh amount)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ENQUIRY_CREATED      â”‚ â€¢ Enquiries list (add new)                     â”‚
â”‚                      â”‚ â€¢ Dashboard (enquiry count++)                  â”‚
â”‚                      â”‚ â€¢ Analytics (lead stats)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ENQUIRY_CONFIRMED    â”‚ â€¢ Enquiries (remove/mark converted)            â”‚
â”‚ (â†’ Booking Created)  â”‚ â€¢ Bookings (add new)                           â”‚
â”‚                      â”‚ â€¢ Rooms (block dates)                          â”‚
â”‚                      â”‚ â€¢ Analytics (conversion rate++)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Implementation Priority

### Phase 1: Core Event System (Week 1)
```
1. Create shared/events.ts
   â””â”€ Event type definitions
   
2. Create server/eventBus.ts
   â””â”€ EventBus class with publish/subscribe
   
3. Update server/storage.ts
   â””â”€ Add EventBus.publish() after each mutation
   
4. Create server/routes.ts SSE endpoint
   â””â”€ GET /api/events/stream
```

### Phase 2: Frontend Integration (Week 1)
```
1. Create client/src/contexts/EventBusProvider.tsx
   â””â”€ EventSource connection to /api/events/stream
   
2. Create client/src/lib/cacheEvents.ts
   â””â”€ Map event types â†’ cache invalidation keys
   
3. Update client/src/App.tsx
   â””â”€ Wrap app in EventBusProvider
   
4. Remove manual invalidateQueries from pages
   â””â”€ Rely on centralized event system
```

### Phase 3: Backend Handlers (Week 2)
```
1. Analytics Recalculation
   â””â”€ Subscribe to BOOKING_*, PAYMENT_*, ORDER_*
   
2. P&L Report Updates
   â””â”€ Subscribe to PAYMENT_*, EXPENSE_*, LEASE_*
   
3. Revenue Stats
   â””â”€ Subscribe to all revenue-generating events
```

---

## âœ… Success Criteria

### User Experience
- âœ… Any action updates ALL related pages **instantly**
- âœ… No need to refresh browser
- âœ… No stale data anywhere in the system
- âœ… Real-time notifications (toasts)
- âœ… Live badge counts (Active Bookings, Orders, etc.)

### Developer Experience
- âœ… Zero manual `queryClient.invalidateQueries()` in pages
- âœ… Add new feature = just publish event
- âœ… Centralized dependency tracking
- âœ… Easy to debug (event logs)

### System Performance
- âœ… UI updates < 500ms after action
- âœ… No unnecessary API calls
- âœ… Efficient cache invalidation
- âœ… Scalable architecture (ready for Redis pub/sub later)

---

**Document Version**: 1.0  
**Last Updated**: November 2, 2025  
**Status**: Ready for Implementation
